# -*- coding: utf-8 -*-
"""Manual UI."""
from __future__ import annotations

import streamlit as st


def render_manual() -> None:
    """Render user manual page."""
    st.subheader("사용 매뉴얼")
    
    left_col, right_col = st.columns([1, 3], gap="large")

    with left_col:
        st.info("궁금한 기능을 선택하세요")
        selection = st.radio(
            "기능 목록",
            ["취합 파일 생성", "파일 병합", "보고 자료 생성", "연간 통계"],
            label_visibility="collapsed"
        )

    with right_col:
        if selection == "취합 파일 생성":
            st.markdown("""
            ### 📂 취합 파일 생성
            **교적부(명단) 파일을 가지고 헌금 입력용 양식(엑셀)을 만드는 기능입니다.**
            
            1. **파일 업로드**: 전체 성도 명단이 들어있는 엑셀 파일을 업로드합니다.
            2. **날짜 선택**: 이번 달 헌금을 입력할 것이므로, **해당 연도와 월**을 선택합니다.
            3. **국내/해외 선택**: 
               - **국내**: 국내 성도들의 입력 양식과 카카오톡/문자 발송용 텍스트를 만듭니다.
               - **해외**: 국가별(러시아, 우크라이나 등)로 엑셀 파일을 자동으로 쪼개서 만들어줍니다.
            4. **다운로드**: 생성된 결과물을 다운로드하여 각 구역장/지역장에게 전달합니다.

            💡 **팁**: 업로드하는 엑셀 파일에는 반드시 `고유번호`, `이름(KR)`, `지역`, `부서` 같은 핵심 정보가 있어야 합니다.
            """)

        elif selection == "파일 병합":
            st.markdown("""
            ### 🔗 파일 병합
            **여러 사람이 작성한 헌금 파일들을 ‘하나의 파일’로 합치는 기능입니다.**
            
            1. **파일 업로드**:
               - **방법 A (낱개 파일)**: 구역장님들이 보내준 엑셀 파일들(`01구역.xlsx`, `02구역.xlsx`...)을 한 번에 드래그해서 올립니다.
               - **방법 B (폴더 통째로)**: 파일이 담긴 폴더를 ZIP으로 압축해서 올릴 수도 있습니다.
            2. **날짜 확인**: 병합할 데이터의 날짜가 맞는지(이번 달이 맞는지) 확인합니다.
            3. **번역 설정 (선택)**: '메모'란에 외국어가 있다면, Gemini AI를 통해 한국어로 자동 번역할 수 있습니다. (건너뛰기 가능)
            4. **결과 확인**:
               - **병합 결과**: 모든 명단이 합쳐진 깨끗한 엑셀 파일입니다.
               - **중복 리포트**: 혹시 한 사람이 두 번 입력되지는 않았는지 확인해줍니다.
            
            💡 **팁**: '고유번호'가 같은 사람은 자동으로 한 줄로 합쳐집니다.
            """)

        elif selection == "보고 자료 생성":
            st.markdown("""
            ### 📊 보고 자료 생성
            **최종 합산된 파일을 가지고, 목사님/재정부 보고용 요약표를 만드는 기능입니다.**
            
            1. **파일 업로드**: [파일 병합] 메뉴에서 만든 **'최종 통합 파일'**을 업로드합니다.
            2. **국내/해외 선택**:
               - 보고하려는 대상이 국내인지 해외인지 선택합니다.
            3. **결과 확인**:
               - **요약표**: 부서별(장년/청년/부녀 등) 납부 인원과 금액, 비율이 표로 정리되어 나옵니다.
               - **텍스트 복사**: 보고서에 바로 붙여넣을 수 있는 줄글 형태의 요약문도 함께 생성됩니다.
            
            💡 **팁**: 이 단계에서는 데이터를 수정하지 않고, 있는 그대로 통계를 내는 것에 집중합니다.
            """)

        elif selection == "연간 통계":
            st.markdown("""
            ### 📅 연간 통계
            **1월부터 12월까지, 1년 치 헌금 흐름을 한눈에 보는 기능입니다.**

            #### 사용 방법이 두 가지가 있습니다!
            
            **상황 1️⃣: "이미 월별 파일(1월.xlsx, 2월.xlsx...)이 다 있어요!"**
            1. 메뉴에서 **[통계]**를 선택합니다.
            2. 가지고 있는 월별 파일들을 몽땅 선택해서 업로드합니다.
            3. **'통계 생성'** 버튼을 누르면 끝! 1년 치 표가 나옵니다.

            **상황 2️⃣: "지역별 파일(1월 폴더, 2월 폴더...)만 잔뜩 있어요!"**
            1. 먼저 메뉴에서 **[병합]**을 선택합니다.
            2. 폴더들을 압축한 ZIP 파일을 올립니다.
            3. 프로그램이 알아서 월별로 파일을 딱딱 정리해서 '월별 통합 파일(ZIP)'을 만들어줍니다. 이걸 다운로드하세요.
            4. 다시 **[통계]** 메뉴로 가서, 방금 받은 ZIP 파일을 그대로 올리면 됩니다.

            💡 **팁**: 결과물 엑셀 파일에는 **'개인별 납부 현황(누가 언제 안 냈는지)'**이 상세하게 나옵니다.
            """)
